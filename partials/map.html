<div ng-controller="MapCtrl">
	<div class="row fullscreenrow">

		<!-- Loading-Icon -->
		<div ng-hide="resultSize >= 0" class="loading"></div>

		<!-- Meldung für leeres Suchergebnis -->
		<div ng-if="resultSize == 0">
			<div class="row" style=" height:{{screenHeight}}px;">
				<div class="col-md-4 col-md-offset-4 text-center">
					Keine Ergebnisse gefunden.
				</div>
			</div>
		</div>

		<!-- Seitenleiste  -->
        <div ng-show="facets" id="mapNavigation" class="col-md-2 well well-sm"
        		style="background-color: rgba(248, 248, 248, 0.8);position: absolute; top: 60px; bottom:10px; right: 10px; overflow-y:auto; z-index:9999;">
        	<div ng-if="facetLimit == mapfacet.values.length" class="alert alert-info">
        		<b>Hinweis:</b>
        		Ihre Auswahl enthält mehr Orte als auf der Karte dargestellt werden können.
        	</div>

    		<a href="search/{{currentQuery.toString()}}" type="button"
    				class="btn btn-primary btn-sm btn-block">
    			Objekte in Auswahl <i class="glyphicon glyphicon-search"> </i>
    		</a>
			<div>
				<h5 class="text-muted uppercase"><strong>Typ der Ortsangabe</strong></h5>
					<div class="btn-group-vertical" style="display:block;" role="group">
						<button class="btn btn-sm btn-default"
								ng-repeat="mapfacetName in mapfacetNames"
								ng-class="{'active': mapfacet.name == mapfacetName}"
								ng-click="switchMapFacet(mapfacetName)">
							{{ mapfacetName | i18n }}
						</button>
					</div>
			</div>
			<div>
				<h5 class="text-muted uppercase"><b>Aktuelle Suche</b></h5>
				<form ng-submit="go('/map/' + currentQuery.setParam('q',q).toString())">
					<input type="text" class="form-control" ng-model="q">
				</form>
			</div>
			<div ar-active-facets route="search" current-query="currentQuery"></div>

			<small>
				<h5 class="text-muted uppercase" ng-hide="resultSize < 2"><b>Filter</b></h5>
				<div ng-hide="resultSize < 2" ng-repeat="facet in facets | filter:'!facet_fundort' | filter:'!facet_aufbewahrungsort' | filter:'!facet_geo' | filter:'!facet_ort'"
						class="panel panel-default facet">
					<div class="panel-heading" ng-click="facet.open = !facet.open" style="padding-left:10px">
						<h5 class="panel-title">
							<span class="glyphicon glyphicon-chevron-down" ng-hide="facet.open" style="color:silver"></span>
							<span class="glyphicon glyphicon-chevron-up" ng-show="facet.open" style="color:silver"></span>	
							&nbsp;{{facet.name | i18n }}
						</h5>
					</div>
					<ul class="list-unstyled facet"	ng-show="facet.open">
						<li ng-repeat="facetValue in facet.values">
							<a ng-href="map/{{currentQuery.addFacet(facet.name,facetValue.value).removeParam('offset').toString()}}">
								<b class="pull-right text-muted">{{facetValue.count | number}}</b>
								{{facetValue.value | stripCoords}}
							</a>
						</li>
					</ul>
				</div>
			</small>
    	</div>

    	<!-- Karte -->
        <div map ng-if="resultSize > 0" mapfacet="mapfacet" facets="facets" current-query="currentQuery" class="col-md-12 fullscreenMap" id="map">

	</div>

</div>