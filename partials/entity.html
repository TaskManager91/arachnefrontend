<script type="text/ng-template" id="section_template.html">
	
	<li ng-if="section.value">
		<div ng-switch="isArray(section.value)">
			<span ng-switch-when="false" ng-bind-html="section.value"></span>
			<ul ng-switch-when="true">
				<li ng-repeat="valueItem in section.value" ng-bind-html="valueItem"></li>
			</ul>
		</div>
	</li>



	<ul ng-if="!section.value">
		<b>{{section.label}}</b>
		<li ng-repeat="section in section.content" ng-include="'section_template.html'"></li>
	</ul>

</script>

<div class="row"  ng-controller="EntityCtrl as entityCtrl">

	<script type="text/ng-template" id="createBookmark.html">
		<div class="modal-header">
			<h4 class="modal-title"><img src="img/arachnelogo.png" style="height: 36px; opacity: 0.43; width: 36px;"></img>Neue Bookmark anlegen:
			</h4>
		</div>
		<div class="modal-body">	
			<li class="dropdown">
			  	<a class="dropdown-toggle">
			    	{{ selected.item.name }}
			  	</a>
			  	<ul class="dropdown-menu">
			    	<li ng-repeat="item in items">
			      		<a ng-click="selected.item = item">{{ item.name }}</a>
			    	</li>
			  	</ul>
			</li>

			<div class="form-group" >
				<input type="text" class="form-control" ng-model="selected.commentary">
			</div>
			<div class="modal-footer">
            	<button class="btn btn-primary" ng-click="$close(selected)">OK</button>
            	<button class="btn btn-warning" ng-click="$dismiss()">Cancel</button>
        	</div>
		</div>
	</script> 

	<div class="col-md-2" style="padding-top:40px" ng-show="currentSearch">
		<b class="text-muted small uppercase">Aktuelle Suche</b><br>
		Suche nach <b>{{currentSearch.queryParams.q}}</b>

		<div style="overflow:hidden">
			{{currentSearch.queryParams.fq}}	
		</div>

		<div class="row" ng-repeat="entityCurrent in currentSearch.results.entities" ng-if="entity.entityId == entityCurrent.entityId">
			<div ng-if="$index-1 >= 0">
				<a href="entity/{{ currentSearch.results.entities[$index-1].entityId }}" >
					<button type="button" class="btn btn-default btn-lg"> 
						<span class="glyphicon glyphicon-arrow-left" ></span>
					</button>
				</a>
			</div>
			<div ng-if="!$last">
				<a href="entity/{{ currentSearch.results.entities[$index+1].entityId }}" >
				<button type="button" class="btn btn-default btn-lg"> 
					<span class="glyphicon glyphicon-arrow-right" ></span>
				</button>
				</a>
			</div>
		</div>
	</div>
	<div class="col-md-6">
		<div class="page-header">
			
			<h3>
				{{ entity.title }} &nbsp; <small>{{ entity.subtitle }}</small>
			</h3>

		</div>
		
	
		{{entity.sections.label}}
		<div ng-repeat="section in entity.sections.content" ng-include="'section_template.html'"></div>		
		
	</div>
	<div class="col-md-4">
		<div ng-if="isBookmark">
			Bookmark: {{ bookmark.commentary }}
			<button type="button" class="btn btn-default" ng-click="deleteBookmark()">delete Bookmark</button>
		</div>
		<button type="button" class="btn btn-default" ng-click="createBookmarkModal()" ng-if="!isBookmark">Bookmark!</button>
		<div class="Bilder-Container" ng-if="entity.thumbnailId">
			<a href="entity/image/{{ entity.thumbnailId }}"><img ng-src="http://crazyhorse.archaeologie.uni-koeln.de/arachnedataservice/image/height/{{ entity.thumbnailId }}?height=300"></img></a>
		</div>
		
		<div class="page-header">
			<h3>{{ 'msg_relatedObjects' | i18n }}</h3>
		</div>

		<accordion close-others="true">
			<accordion-group is-open="false" ng-repeat="facetValue in context" ng-click="loadFacetValue(facetValue)" ng-switch="facetValue.facetValueName == 'marbilder' || facetValue.facetValueName == 'buchseite'">
				<accordion-heading>
					<span class="capitalized">{{facetValue.facetValueName}}</span> <span class="badge pull-right">{{facetValue.count}}</span>
				</accordion-heading>
				<span class="list-group-item" ng-if="!facetValue.entities.length" >{{ 'msg_loading...' | i18n }} </span>
				<div ng-switch-when="true">
					<a  href="entity/{{entity.entityId}}" ng-repeat="entity in facetValue.entities">
						<img class="col-md-3" style="padding: 4px; max-height:70px" ng-src="http://crazyhorse.archaeologie.uni-koeln.de/arachnedataservice/image/thumbnail/{{entity.thumbnailId}}">
					</a>
				</div>
				<div ng-switch-default="">
					<a class="list-group-item" href="entity/{{entity.entityId}}" ng-repeat="entity in facetValue.entities">
						{{entity.title}}
					</a>
				</div>
		    </accordion-group>
		</accordion>

	</div>
</div>